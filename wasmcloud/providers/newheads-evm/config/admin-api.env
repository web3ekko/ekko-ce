# Environment configuration for Newheads Provider with Admin API
# Copy to .env and configure for your environment

# ===== DATABASE CONFIGURATION =====

# PostgreSQL connection for persistent configuration storage
POSTGRES_URL=postgresql://ekko_user:ekko_password@localhost:5432/ekko_newheads
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_DB=ekko_newheads
POSTGRES_USER=ekko_user
POSTGRES_PASSWORD=ekko_password

# Redis connection for configuration caching
REDIS_URL=redis://localhost:6379/0
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_DB=0
REDIS_PASSWORD=

# Cache TTL in seconds (default: 5 minutes)
CONFIG_CACHE_TTL=300

# ===== ADMIN API CONFIGURATION =====

# Admin API server settings
ADMIN_API_HOST=0.0.0.0
ADMIN_API_PORT=8080
ADMIN_API_BASE_PATH=/api/v1

# JWT settings for admin authentication
JWT_SECRET=your-super-secret-jwt-key-change-this-in-production
JWT_EXPIRY_HOURS=24

# Rate limiting
RATE_LIMIT_PER_MINUTE=60
RATE_LIMIT_BURST=10

# CORS settings
CORS_ALLOWED_ORIGINS=http://localhost:3000,http://localhost:8080
CORS_ALLOWED_METHODS=GET,POST,PUT,DELETE,OPTIONS
CORS_ALLOWED_HEADERS=Content-Type,Authorization

# ===== BLOCKCHAIN RPC ENDPOINTS =====

# Ethereum
ETHEREUM_RPC_URL=https://mainnet.infura.io/v3/YOUR_PROJECT_ID
ETHEREUM_WS_URL=wss://mainnet.infura.io/ws/v3/YOUR_PROJECT_ID
ETHEREUM_ENABLED=false

ETHEREUM_GOERLI_RPC_URL=https://goerli.infura.io/v3/YOUR_PROJECT_ID
ETHEREUM_GOERLI_WS_URL=wss://goerli.infura.io/ws/v3/YOUR_PROJECT_ID
ETHEREUM_GOERLI_ENABLED=false

ETHEREUM_SEPOLIA_RPC_URL=https://sepolia.infura.io/v3/YOUR_PROJECT_ID
ETHEREUM_SEPOLIA_WS_URL=wss://sepolia.infura.io/ws/v3/YOUR_PROJECT_ID
ETHEREUM_SEPOLIA_ENABLED=false

# Polygon
POLYGON_RPC_URL=https://polygon-mainnet.infura.io/v3/YOUR_PROJECT_ID
POLYGON_WS_URL=wss://polygon-mainnet.infura.io/ws/v3/YOUR_PROJECT_ID
POLYGON_ENABLED=false

POLYGON_MUMBAI_RPC_URL=https://polygon-mumbai.infura.io/v3/YOUR_PROJECT_ID
POLYGON_MUMBAI_WS_URL=wss://polygon-mumbai.infura.io/ws/v3/YOUR_PROJECT_ID
POLYGON_MUMBAI_ENABLED=false

# Arbitrum
ARBITRUM_RPC_URL=https://arbitrum-mainnet.infura.io/v3/YOUR_PROJECT_ID
ARBITRUM_WS_URL=wss://arbitrum-mainnet.infura.io/ws/v3/YOUR_PROJECT_ID
ARBITRUM_ENABLED=false

# Optimism
OPTIMISM_RPC_URL=https://optimism-mainnet.infura.io/v3/YOUR_PROJECT_ID
OPTIMISM_WS_URL=wss://optimism-mainnet.infura.io/ws/v3/YOUR_PROJECT_ID
OPTIMISM_ENABLED=false

# Binance Smart Chain
BSC_RPC_URL=https://bsc-dataseed.binance.org
BSC_WS_URL=wss://bsc-ws-node.nariox.org:443/ws
BSC_ENABLED=false

# Avalanche
AVALANCHE_RPC_URL=https://api.avax.network/ext/bc/C/rpc
AVALANCHE_WS_URL=wss://api.avax.network/ext/bc/C/ws
AVALANCHE_ENABLED=false

# Bitcoin (future)
BITCOIN_RPC_URL=https://bitcoin-mainnet.example.com
BITCOIN_WS_URL=wss://bitcoin-mainnet.example.com/ws
BITCOIN_ENABLED=false

# Solana (future)
SOLANA_RPC_URL=https://api.mainnet-beta.solana.com
SOLANA_WS_URL=wss://api.mainnet-beta.solana.com
SOLANA_ENABLED=false

# ===== NATS CONFIGURATION =====

# NATS server connection
NATS_URL=nats://localhost:4222
NATS_USER=
NATS_PASSWORD=
NATS_TOKEN=

# NATS subject prefixes
NATS_NEWHEADS_PREFIX=newheads
NATS_CONFIG_PREFIX=config
NATS_STATUS_PREFIX=status
NATS_CONTROL_PREFIX=control

# ===== PROVIDER CONFIGURATION =====

# Provider settings
PROVIDER_NAME=newheads-provider
PROVIDER_VERSION=0.1.0
PROVIDER_DESCRIPTION="Blockchain newheads streaming provider"

# Health check settings
HEALTH_CHECK_INTERVAL=30000  # milliseconds
HEALTH_CHECK_TIMEOUT=5000    # milliseconds

# Reconnection settings
RECONNECT_INTERVAL=5000      # milliseconds
MAX_RECONNECT_ATTEMPTS=10
RECONNECT_BACKOFF_MULTIPLIER=2.0
MAX_RECONNECT_INTERVAL=300000  # 5 minutes

# WebSocket settings
WS_PING_INTERVAL=30000       # milliseconds
WS_PONG_TIMEOUT=10000        # milliseconds
WS_MESSAGE_BUFFER_SIZE=1000

# ===== LOGGING CONFIGURATION =====

# Logging level (trace, debug, info, warn, error)
RUST_LOG=info
LOG_LEVEL=info
LOG_FORMAT=json  # json or text

# Log file settings (optional)
LOG_FILE_PATH=/var/log/newheads-provider.log
LOG_FILE_MAX_SIZE=100MB
LOG_FILE_MAX_FILES=10

# ===== MONITORING CONFIGURATION =====

# Metrics settings
METRICS_ENABLED=true
METRICS_PORT=9090
METRICS_PATH=/metrics

# Prometheus settings
PROMETHEUS_NAMESPACE=ekko
PROMETHEUS_SUBSYSTEM=newheads

# Health check endpoint
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_PORT=8081
HEALTH_CHECK_PATH=/health

# ===== SECURITY CONFIGURATION =====

# TLS settings (for production)
TLS_ENABLED=false
TLS_CERT_PATH=/etc/ssl/certs/newheads-provider.crt
TLS_KEY_PATH=/etc/ssl/private/newheads-provider.key

# API key settings
API_KEY_HEADER=X-API-Key
API_KEY_REQUIRED=false

# Admin user settings (for initial setup)
ADMIN_USERNAME=admin
ADMIN_EMAIL=admin@ekko.zone
ADMIN_PASSWORD=change-this-password-in-production

# ===== DEVELOPMENT SETTINGS =====

# Development mode
DEV_MODE=true
DEV_AUTO_RELOAD=true
DEV_MOCK_BLOCKCHAIN=false

# Test settings
TEST_MODE=false
TEST_MOCK_RESPONSES=false
TEST_SLOW_RESPONSES=false

# ===== PRODUCTION SETTINGS =====

# Production optimizations
PRODUCTION_MODE=false
ENABLE_COMPRESSION=true
ENABLE_CACHING=true
CACHE_STATIC_ASSETS=true

# Resource limits
MAX_CONCURRENT_CONNECTIONS=1000
MAX_MEMORY_USAGE=512MB
MAX_CPU_USAGE=80%

# Backup settings
BACKUP_ENABLED=false
BACKUP_INTERVAL=24h
BACKUP_RETENTION=7d
BACKUP_S3_BUCKET=ekko-newheads-backups

# ===== EXAMPLE USAGE =====
#
# 1. Copy this file to .env:
#    cp admin-api.env .env
#
# 2. Update the configuration values:
#    - Set your Infura/Alchemy API keys
#    - Configure database connections
#    - Set admin credentials
#
# 3. Start the services:
#    - Ensure postgres, redis, and nats are running in your environment
#    - Deploy the provider via WADM (recommended)
#
# 4. Access the admin API:
#    curl http://localhost:8080/api/v1/chains
#
# 5. Add a new chain:
#    curl -X POST http://localhost:8080/api/v1/chains \
#      -H "Content-Type: application/json" \
#      -d '{"chain_id": "ethereum-mainnet", ...}'
